<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Meteorological Data Assimilation for Data Scientists &#8212; Improving reanalysis with the Daily Weather Reports</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Improving reanalysis with the Daily Weather Reports" href="index.html" />
    <link rel="next" title="The Daily Weather Reports" href="DWR.html" />
    <link rel="prev" title="Reanalysis and uncertainty" href="reanalysis_and_uncertainty.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Improving reanalysis with DWR</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="reanalysis_and_uncertainty.html" title="Reanalysis and uncertainty"
             accesskey="P">previous</a> |
          <a href="DWR.html" title="The Daily Weather Reports"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="meteorological-data-assimilation-for-data-scientists">
<h1>Meteorological Data Assimilation for Data Scientists<a class="headerlink" href="#meteorological-data-assimilation-for-data-scientists" title="Permalink to this headline">Â¶</a></h1>
<p>Suppose we have an uncertain estimate of the weather (MSLP) at some point in the past, perhaps <a class="reference external" href="reanalysis_and_uncertainty.html">from a reanalysis</a>, and then we get some new information, in the form of a station observation from that date and time. How can we use that new station observation to improve the MSLP estimate?</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="figure align-center" id="id1" style="width: 700px">
<a class="reference internal image-reference" href="_images/With_FW_1903102218.png"><img alt="_images/With_FW_1903102218.png" src="_images/With_FW_1903102218.png" style="width: 650px;" /></a>
<p class="caption"><span class="caption-text">MSLP Contours for 20CR2c for October 22nd, 1903 (at 6pm).</span></p>
<div class="legend">
<a class="reference external" href="analyses/spaghetti_contour/spaghetti_contour.html">Spaghetti-contour plot</a> of mean-sea-level pressure, and the location of the Fort William station (red dot), where we have new observational data from <a class="reference external" href="http://weatherrescue.org">Weather Rescue</a></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>We can edit the reanalysis ensemble at the location of the new observation - setting all ensemble members to the observed value, but we would like to do more than this, to use information from the observation at nearby locations as well. To decide how to modify the mslp at, say, Stornoway and London, in response to an observation at Fort William, we need to know mslp variability in those places relates to weather variability at the location of the observation. However, we can estimate this directly from the ensemble:</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="figure align-center" id="id2" style="width: 700px">
<a class="reference internal image-reference" href="_images/lr+contour_1903102218.png"><img alt="_images/lr+contour_1903102218.png" src="_images/lr+contour_1903102218.png" style="width: 650px;" /></a>
<p class="caption"><span class="caption-text">MSLP at Fort William, Stornoway, and London (October 22nd, 1903 at 6pm).</span></p>
<div class="legend">
The red dot marks Fort William, the blue Stornoway, and the black London. Scatter plots show relationship between their mslp, in the 20CR2c ensemble for this particular point in time.</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>In the 20CR2c ensemble, at this point in time, the mslp at Stornoway is highly correlated with that at Fort William, so an observation at Fort William is telling us a lot about the mslp at Stornoway, and we should move the mslp estimates at Stornoway in response to the observation in much the same way as we move the estimates at Fort William. At London, on the other hand, the mslp is almost uncorrelated with that at Fort William, so an observation at Fort William is telling us little about the mslp at London, and we should leave the ensemble at London unchanged whatever the observation at Fort William is.</p>
<p>We can formalise this by fitting a model (<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html#sklearn.linear_model.LinearRegression" title="(in scikit-learn v0.19.1)"><code class="xref py py-obj docutils literal"><span class="pre">sklearn.linear_model.LinearRegression</span></code></a>):</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="figure align-center" id="id3" style="width: 700px">
<a class="reference internal image-reference" href="_images/before+after_1903102218.png"><img alt="_images/before+after_1903102218.png" src="_images/before+after_1903102218.png" style="width: 650px;" /></a>
<p class="caption"><span class="caption-text">MSLP at Stornoway, before and after assimilating the Fort William observation.</span></p>
<div class="legend">
Scatter plots of 20CR2c ensemble pressures at Stornoway at 6pm on 22nd October 1903 against Fort William ensemble pressures. The Stornoway pressures are adjusted by fitting a linear regression (left plot) and then removing the fit from each value (right plot). We can do the same for the London pressures, but in that case the adjustment will make almost no difference, as the fit line has close to zero slope.</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>To assimilate the Fort William observation, we apply the same process illustrated above for Stornoway to each grid-point in the reanalyis field:</p>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface (what this is, and why)</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="reanalysis_and_uncertainty.html">Reanalysis and uncertainty</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Meteorological Data Assimilation for Data Scientists</a></li>
<li class="toctree-l1"><a class="reference internal" href="DWR.html">The Daily Weather Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="improving_with_dwr.html">Improving the reanalyses with DWR</a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusions.html">Conclusions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="credits_and_feedback.html">Who to credit, and how to give feedback</a></li>
<li class="toctree-l1"><a class="reference internal" href="replication_and_extension.html">How to replicate and extend this</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="analyses/analyses.html">Appendix: Analyses of the DWR data</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/modules.html">Appendix: python modules</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="reanalysis_and_uncertainty.html" title="Reanalysis and uncertainty"
              >previous</a> |
            <a href="DWR.html" title="The Daily Weather Reports"
              >next</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/da_for_ds.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>